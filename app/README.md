# Порядок запуска

### Связанное

Для полноценной работы следует скачать ПО, разбивающее текст из PDF на чанки (https://github.com/RudyCentipede/satellite-chunker#)

### ⚙️ Порядок запуска и использования

Следуйте этим шагам для развертывания системы и получения первого ответа.

#### Шаг 1: Первичная настройка (выполняется один раз)

1.  **Клонируйте репозиторий и установите зависимости:**
    ```bash
    git clone https://github.com/ваш-логин/spacecraft-doc-assistant.git
    cd llm-decision-support-mvp
    python -m venv venv
    pip install -r requirements.txt
    ```

2.  **Настройте переменные окружения:**
    Создайте файл `.env` в корневой папке и настройте в нем пути.

3.  **Запустите сервер базы данных Qdrant:**
    Убедитесь, что Docker Desktop запущен, и выполните команду:
    ```bash
    docker run -p 6333:6333 -p 6334:6334 -v "$(pwd)/qdrant_data":/qdrant/storage qdrant/qdrant
    ```
    *Этот терминал должен оставаться открытым на все время работы с базой данных.*

#### Шаг 2: Подготовка и индексация данных (загрузка знаний в систему)

1.  **Подготовьте исходные данные:**
    Убедитесь, что файл с текстовыми чанками (например, `input_data.jsonl`) находится в нужной директории, указанной в конфигурации.

2.  **Выполните векторизацию и загрузку:**
    Откройте **новый** терминал (не тот, где запущен Docker), активируйте `venv` и выполните команду:
    ```bash
    python.exe run_query.py
    ```
    *Этот процесс может занять значительное время при первом запуске, так как он скачивает и использует большую модель для создания векторов.*
    Убедитесь, то что пути в .env файле указаны верно и база данных qdrant запущена.
    После завершения ваши документы будут загружены в базу данных Qdrant.
    В случае возникновения прерывания на каком-либо из этапов предусмотрены специальные ключи запуска, чтобы пропустить некоторые этапы загрузки

#### Шаг 3: Получение ответа на запрос

Это основной рабочий цикл, который вы будете выполнять каждый раз, когда захотите задать вопрос.

1.  **Сформулируйте ваш вопрос.** Откройте файл `data/request.txt` и напишите в него ваш вопрос. Сохраните файл.

2.  **Запустите основной скрипт обработки запроса.** В терминале с активированным виртуальным окружением выполните команду:
    ```bash
    python run_query_app.py
    ```

3.  **Получите результат.** Программа выполнит всю цепочку:
    *   Векторизует ваш запрос (используя кэш, если вопрос не менялся).
    *   Найден релевантную информацию в Qdrant.
    *   Очистит память от тяжелой модели эмбеддингов.
    *   Сформирует промпт и отправит его в LLM.
    *   Сохранит финальный, структурированный ответ в файл `data/answer.txt`.

#### Завершение работы

**Остановите сервер Qdrant.** Вернитесь в терминал, где был запущен Docker (из Шага 1), и нажмите `Ctrl + C`.